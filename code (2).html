<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-key="documentTitle">IgniteInbox: Your AI-Powered Outreach Engine</title>
    
    <!-- Google Fonts: Inter for LTR, Cairo for RTL -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* Base styles & reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #3a006c 0%, #6f0088 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: font-family 0.3s ease-in-out;
            position: relative; /* For particle background */
            overflow-x: hidden; /* Prevent horizontal scroll from particles */
        }

        /* Specific font and direction for Arabic text */
        body[dir="ar"] {
            font-family: 'Cairo', 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Animated background particles */
        .particle-container {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
        }
        .particle {
            position: absolute;
            width: 4px; /* w-1 becomes 4px by default in Tailwind, but 1px is fine for small dots */
            height: 4px;
            background-color: rgba(255, 255, 255, 0.3); /* opacity-30 */
            border-radius: 50%;
            animation: pulse-fade 3s infinite alternate; /* animate-pulse */
        }
        @keyframes pulse-fade {
            0% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
            100% { opacity: 0.3; transform: scale(1); }
        }

        .container {
            max-width: 1024px; /* max-w-6xl */
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            padding-left: 1.25rem; /* px-5 */
            padding-right: 1.25rem; /* px-5 */
            padding-top: 3rem; /* py-12 */
            padding-bottom: 3rem; /* py-12 */
            position: relative;
            z-index: 10;
        }

        .header {
            text-align: center;
            margin-bottom: 5rem; /* mb-20 */
            animation: fadeIn 1s ease-out forwards; /* animate-fade-in */
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Red Flame Logo Styling */
        .red-flame-logo {
            left: -80px;
            bottom: -65px;
            position: relative;
            width: 40px; /* w-10 */
            height: 56px; /* h-14 */
            flex-shrink: 0;
            margin-right: 1rem; /* gap-4 */
            margin-bottom: 1.5rem; /* mb-6 */
        }
        .red-flame-logo-main {
            position: absolute;
            width: 32px; /* w-8 */
            height: 48px; /* h-12 */
            background: linear-gradient(to top, #dc2626, #ef4444, #f87171); /* from-red-600 via-red-500 to-red-400 */
            border-radius: 9999px; /* rounded-full */
            transform: rotate(12deg);
            animation: pulse-light 2s infinite alternate; /* animate-pulse */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
            left: 5px; /* Adjusted for centering */
        }
        .red-flame-logo-inner-orange-red {
            position: absolute;
            top: 4px; /* top-1 */
            left: 9px; /* left-1 + 8px for main flame adjustment */
            width: 24px; /* w-6 */
            height: 36px; /* h-9 */
            background: linear-gradient(to top, #ef4444, #f97316, #f87171); /* from-red-500 via-orange-500 to-red-400 */
            border-radius: 9999px;
            transform: rotate(-12deg);
            animation: pulse-light 2s infinite alternate;
        }
        .red-flame-logo-core-orange {
            position: absolute;
            top: 8px; /* top-2 */
            left: 13px; /* left-2 + 8px for main flame adjustment */
            width: 16px; /* w-4 */
            height: 28px; /* h-7 */
            background: linear-gradient(to top, #ea580c, #fb923c, #facc15); /* from-orange-600 via-orange-400 to-yellow-500 */
            border-radius: 9999px;
            animation: pulse-light 2s infinite alternate;
        }
        .red-flame-logo-inner-yellow-orange {
            position: absolute;
            top: 12px; /* top-3 */
            left: 15px; /* left-2.5 + 8px for main flame adjustment */
            width: 12px; /* w-3 */
            height: 20px; /* h-5 */
            background: linear-gradient(to top, #fb923c, #facc15, #fde047); /* from-orange-400 via-yellow-500 to-yellow-300 */
            border-radius: 9999px;
            animation: pulse-light 2s infinite alternate;
        }
        .red-flame-logo-center-hotspot {
            position: absolute;
            top: 16px; /* top-4 */
            left: 17px; /* left-3 + 8px for main flame adjustment */
            width: 8px; /* w-2 */
            height: 12px; /* h-3 */
            background: linear-gradient(to top, #facc15, #fef08a); /* from-yellow-400 to-yellow-200 */
            border-radius: 9999px;
            animation: pulse-light 2s infinite alternate;
        }
        .red-flame-logo-glow {
            position: absolute;
            inset: 0;
            width: 40px;
            height: 56px;
            background-color: rgba(239, 68, 68, 0.3); /* bg-red-500/30 */
            border-radius: 9999px;
            filter: blur(16px); /* blur-md */
            animation: pulse-light 2s infinite alternate;
        }
        @keyframes pulse-light {
            0% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 0.9; }
            100% { transform: scale(1); opacity: 0.7; }
        }


        .header h1 {
            font-size: clamp(3rem, 8vw, 4.5rem); /* text-5xl sm:text-6xl lg:text-7xl (using clamp for similar effect) */
            font-weight: 700; /* font-bold */
            background: linear-gradient(to right, #ffffff, #f3f4f6, #e5e7eb); /* from-white via-gray-100 to-gray-200 */
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent; /* text-transparent */
            line-height: 1.25; /* leading-tight */
            letter-spacing: -0.025em; /* tracking-tight */
            margin-bottom: 0; /* Gap handled by parent flex */
        }

        .header .space-y-3 {
            margin-top: 1.5rem; /* Adjusted from space-y-3 */
        }

        .header .space-y-3 p {
            margin-bottom: 0.75rem; /* For space-y-3 effect */
        }

        .header .space-y-3 p:last-child {
            margin-bottom: 0;
        }

        .header .space-y-3 p:first-child {
            font-size: clamp(1.125rem, 3vw, 1.875rem); /* text-xl sm:text-2xl lg:text-3xl */
            color: rgba(255, 255, 255, 0.95); /* text-white/95 */
            font-weight: 300; /* font-light */
            letter-spacing: 0.025em; /* tracking-wide */
        }

        .header .space-y-3 p:last-child {
            font-size: clamp(1rem, 2vw, 1.125rem); /* text-base sm:text-lg */
            color: rgba(255, 255, 255, 0.8); /* text-white/80 */
            font-weight: 300; /* font-light */
            max-width: 42rem; /* max-w-2xl */
            margin-left: auto;
            margin-right: auto;
        }

        /* Language selector */
        .language-selector-container {
            position: fixed; /* fixed */
            top: 2rem; /* top-8 */
            right: 2rem; /* right-8 */
            z-index: 50; /* z-50 */
            display: flex; /* flex */
            gap: 0.75rem; /* gap-3 */
        }
        body[dir="ar"] .language-selector-container {
            left: 2rem;
            right: auto;
            flex-direction: row-reverse; /* For correct button order in RTL */
        }

        .language-selector-container button {
            padding: 0.625rem 1rem; /* px-4 py-2.5 */
            background-color: rgba(255, 255, 255, 0.1); /* bg-white/10 */
            backdrop-filter: blur(12px); /* backdrop-blur-lg */
            border: 1px solid rgba(255, 255, 255, 0.2); /* border border-white/20 */
            border-radius: 9999px; /* rounded-full */
            color: white;
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            transition: all 0.3s ease; /* transition-all duration-300 */
            cursor: pointer;
        }
        .language-selector-container button:hover {
            background-color: rgba(255, 255, 255, 0.2); /* hover:bg-white/20 */
            transform: translateY(-2px) scale(1.05); /* hover:-translate-y-0.5 hover:scale-105 */
        }
        .language-selector-container button.active {
            background-color: rgba(255, 255, 255, 0.3); /* A slightly more active state */
            border-color: rgba(255, 255, 255, 0.5);
        }

        /* Main form grid */
        .grid-container {
            display: grid;
            gap: 2.5rem; /* gap-10 */
            margin-bottom: 2.5rem; /* mb-10 */
        }
        @media (min-width: 1024px) { /* lg:grid-cols-2 */
            .grid-container {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        .card {
            background-color: rgba(255, 255, 255, 0.1); /* bg-white/10 */
            backdrop-filter: blur(12px); /* backdrop-blur-xl */
            border: 1px solid rgba(255, 255, 255, 0.2); /* border border-white/20 */
            border-radius: 1.5rem; /* rounded-3xl */
            padding: 2rem; /* p-8 */
            transition: all 0.5s ease; /* transition-all duration-500 */
        }
        .card:hover {
            transform: translateY(-0.5rem); /* hover:-translate-y-2 */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); /* hover:shadow-2xl */
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem; /* gap-4 */
            margin-bottom: 2rem; /* mb-8 */
        }
        body[dir="ar"] .card-header {
            flex-direction: row-reverse; /* Reverse icon and text for RTL */
            justify-content: flex-end; /* Align to the right */
        }

        .card-header svg {
            width: 2rem; /* w-8 */
            height: 2rem; /* h-8 */
            flex-shrink: 0;
        }
        .card-header h2 {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: white;
        }

        .text-blue-300 { color: #93c5fd; }
        .text-green-300 { color: #86efac; }
        .text-pink-300 { color: #f9a8d4; } /* Adjusted for Mail icon */


        .space-y-5 > div, .space-y-5 > input, .space-y-5 > select, .space-y-5 > textarea {
            margin-bottom: 1.25rem; /* space-y-5 */
        }
        .space-y-5 > div:last-child, .space-y-5 > input:last-child, .space-y-5 > select:last-child, .space-y-5 > textarea:last-child {
            margin-bottom: 0;
        }

        .form-input {
            width: 100%;
            padding: 1rem 1.25rem; /* px-5 py-4 */
            background-color: rgba(255, 255, 255, 0.1); /* bg-white/10 */
            border: 2px solid rgba(255, 255, 255, 0.2); /* border-2 border-white/20 */
            border-radius: 1rem; /* rounded-2xl */
            color: white;
            transition: all 0.3s ease; /* transition-all duration-300 */
        }
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.6); /* placeholder-white/60 */
        }
        .form-input:focus {
            border-color: rgba(255, 255, 255, 0.5); /* focus:border-white/50 */
            background-color: rgba(255, 255, 255, 0.15); /* focus:bg-white/15 */
            transform: scale(1.02); /* focus:scale-105 - slightly reduced for smoother feel */
            outline: none;
        }
        body[dir="ar"] .form-input {
            text-align: right;
        }
        body[dir="ar"] .form-input::placeholder {
            text-align: right;
        }

        textarea.form-input {
            resize: vertical; /* resize-none */
            min-height: 5rem; /* Added min-height for usability */
        }

        select.form-input {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            cursor: pointer;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%20viewBox%3D%220%200%20292.4%20292.4%22%3E%3Cpath%20fill%3D%22white%22%20d%3D%22M287%2C197.9L146.2%2C57.1L5.4%2C197.9h281.6z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 0.8em;
            padding-right: 2.5rem;
        }
        body[dir="ar"] select.form-input {
            background-position: left 1rem center;
            padding-left: 2.5rem;
            padding-right: 1.5rem;
            text-align: right;
            text-align-last: right; /* For Firefox */
        }

        select.form-input option {
            background-color: #5a157e; /* bg-purple-800 */
            color: white;
        }


        /* Generate button */
        .generate-btn {
            width: 100%;
            padding: 1.5rem 0; /* py-6 */
            background: linear-gradient(to right, #ef4444, #f59e0b); /* from-red-500 to-yellow-500 */
            border-radius: 1.5rem; /* rounded-3xl */
            color: white;
            font-size: 1.25rem; /* text-xl */
            font-weight: 600; /* font-semibold */
            transition: all 0.3s ease; /* transition-all duration-300 */
            cursor: pointer;
            margin-bottom: 2.5rem; /* mb-10 */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem; /* gap-3 */
            position: relative;
            overflow: hidden;
        }
        .generate-btn:hover {
            transform: translateY(-0.25rem); /* hover:-translate-y-1 */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); /* hover:shadow-2xl */
        }
        .generate-btn:disabled {
            opacity: 0.5; /* disabled:opacity-50 */
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .generate-btn-shine { /* Added for the shine effect */
            position: absolute;
            inset: 0;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.2), transparent); /* from-transparent via-white/20 to-transparent */
            transform: translateX(-100%); /* -translate-x-full */
            animation: shine 1s infinite forwards; /* group-hover:translate-x-full transition-transform duration-1000, simplified */
            animation-play-state: paused; /* Pause by default */
        }
        .generate-btn:hover .generate-btn-shine {
            animation-play-state: running;
            animation-iteration-count: 1; /* Run once on hover */
        }
        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .generate-btn svg {
            width: 1.5rem; /* w-6 */
            height: 1.5rem; /* h-6 */
        }
        .generate-btn .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }


        /* Output section */
        .output-section {
            background-color: rgba(255, 255, 255, 0.1); /* bg-white/10 */
            backdrop-filter: blur(12px); /* backdrop-blur-xl */
            border: 1px solid rgba(255, 255, 255, 0.2); /* border border-white/20 */
            border-radius: 1.5rem; /* rounded-3xl */
            padding: 2rem; /* p-8 */
        }

        .output-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem; /* mb-6 */
        }
        body[dir="ar"] .output-header {
            flex-direction: row-reverse; /* Reverse order for RTL */
        }

        .output-header .flex-gap-4 { /* Added for the h2 and icon */
            display: flex;
            align-items: center;
            gap: 1rem; /* gap-4 */
        }
        body[dir="ar"] .output-header .flex-gap-4 {
            flex-direction: row-reverse;
        }

        .output-header svg {
            width: 2rem; /* w-8 */
            height: 2rem; /* h-8 */
        }
        .output-header h2 {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: white;
        }

        .copy-btn {
            padding: 0.75rem 1.5rem; /* px-6 py-3 */
            border: 1px solid rgba(255, 255, 255, 0.3); /* border border-white/30 */
            border-radius: 0.75rem; /* rounded-xl */
            color: white;
            transition: all 0.3s ease; /* transition-all duration-300 */
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem; /* gap-2 */
            background-color: rgba(255, 255, 255, 0.1); /* bg-white/10 */
        }
        .copy-btn:hover {
            transform: translateY(-0.25rem); /* hover:-translate-y-1 */
            background-color: rgba(255, 255, 255, 0.2); /* hover:bg-white/20 */
        }
        .copy-btn.success { /* class .success for green check */
            background-color: rgba(16, 185, 129, 0.2); /* bg-green-500/20 */
            border-color: rgba(52, 211, 153, 0.5); /* border-green-400/50 */
        }
        .copy-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .copy-btn svg {
            width: 1rem; /* w-4 */
            height: 1rem; /* h-4 */
        }

        .output-content-box {
            background-color: rgba(0, 0, 0, 0.2); /* bg-black/20 */
            border-radius: 1rem; /* rounded-2xl */
            padding: 1.5rem; /* p-6 */
            min-height: 13rem; /* min-h-52 */
            border: 1px solid rgba(255, 255, 255, 0.1); /* border border-white/10 */
            display: flex; /* For centering loading/initial text */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center; /* For initial/loading text */
        }
        body[dir="ar"] .output-content-box {
            text-align: right; /* For generated email */
            align-items: flex-end; /* For generated email */
        }
        .output-content-box pre {
            color: rgba(255, 255, 255, 0.9); /* text-white/90 */
            white-space: pre-wrap; /* whitespace-pre-wrap */
            font-family: inherit; /* font-sans, use body font */
            line-height: 1.625; /* leading-relaxed */
            width: 100%; /* Ensure pre takes full width */
            text-align: left; /* Default for pre */
        }
        body[dir="ar"] .output-content-box pre {
            text-align: right; /* Align pre text to right for RTL */
        }

        .output-content-box p.initial-text {
            color: rgba(255, 255, 255, 0.5); /* text-white/50 */
            font-style: italic;
            padding-top: 3rem; /* py-12 */
            padding-bottom: 3rem; /* py-12 */
        }
        .output-content-box .loading-animation {
            width: 2.5rem; /* w-10 */
            height: 2.5rem; /* h-10 */
            animation: spin 1s linear infinite; /* animate-spin */
            margin-bottom: 1rem; /* mb-4 */
        }
        .output-content-box .loading-text {
            color: rgba(255, 255, 255, 0.8); /* text-white/80 */
        }

        /* --- RESPONSIVE STYLES --- */
        @media (max-width: 768px) {
            body {
                padding: 20px 10px;
                align-items: flex-start; /* Align to top on smaller screens */
            }
            .container {
                padding: 2rem 1rem; /* py-8 px-4 */
            }
            .language-selector-container {
                top: 1rem;
                right: 1rem;
            }
            body[dir="ar"] .language-selector-container {
                left: 1rem;
                right: auto;
            }
            .language-selector-container button {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }
            .red-flame-logo {
                width: 32px; /* w-8 */
                height: 44px; /* h-11 */
            }
            .red-flame-logo-main { width: 24px; height: 38px; left: 4px; }
            .red-flame-logo-inner-orange-red { top: 3px; left: 7px; width: 20px; height: 30px; }
            .red-flame-logo-core-orange { top: 6px; left: 9px; width: 14px; height: 24px; }
            .red-flame-logo-inner-yellow-orange { top: 9px; left: 10px; width: 10px; height: 16px; }
            .red-flame-logo-center-hotspot { top: 12px; left: 11px; width: 6px; height: 10px; }
            .red-flame-logo-glow { width: 32px; height: 44px; }

            .header h1 {
                font-size: clamp(2.5rem, 7vw, 3.5rem);
            }
            .header .space-y-3 p:first-child {
                font-size: clamp(1rem, 2.5vw, 1.25rem);
            }
            .header .space-y-3 p:last-child {
                font-size: 0.9rem;
            }
            .grid-container {
                grid-template-columns: 1fr; /* Stacks columns */
                gap: 1.5rem; /* Reduced gap */
            }
            .card {
                padding: 1.5rem; /* p-6 */
            }
            .card-header {
                margin-bottom: 1.5rem; /* mb-6 */
            }
            .card-header svg {
                width: 1.75rem; /* w-7 */
                height: 1.75rem; /* h-7 */
            }
            .card-header h2 {
                font-size: 1.25rem; /* text-xl */
            }
            .space-y-5 > div, .space-y-5 > input, .space-y-5 > select, .space-y-5 > textarea {
                margin-bottom: 1rem;
            }
            .form-input {
                padding: 0.8rem 1rem; /* px-4 py-3 */
                font-size: 1rem;
            }
            textarea.form-input {
                min-height: 4rem;
            }
            .generate-btn {
                padding: 1rem 0; /* py-4 */
                font-size: 1.125rem; /* text-lg */
                margin-bottom: 2rem;
            }
            .generate-btn svg {
                width: 1.25rem; /* w-5 */
                height: 1.25rem; /* h-5 */
            }
            .output-section {
                padding: 1.5rem; /* p-6 */
            }
            .output-header {
                flex-direction: column;
                align-items: flex-start;
                margin-bottom: 1rem;
            }
            body[dir="ar"] .output-header {
                align-items: flex-end;
            }
            .output-header .flex-gap-4 {
                margin-bottom: 0.75rem; /* space between title and button on mobile */
            }
            .output-header h2 {
                font-size: 1.25rem;
            }
            .copy-btn {
                width: 100%;
                justify-content: center;
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
            .output-content-box {
                min-height: 10rem;
                padding: 1rem;
            }
            .output-content-box pre {
                font-size: 0.875rem;
            }
            .output-content-box p.initial-text {
                padding-top: 2rem;
                padding-bottom: 2rem;
            }
            .output-content-box .loading-animation {
                width: 2rem;
                height: 2rem;
            }
            .output-content-box .loading-text {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px 5px;
            }
            .container {
                padding: 1.5rem 0.75rem;
            }
            .header h1 {
                font-size: clamp(2rem, 9vw, 3rem);
            }
            .header .space-y-3 p:first-child {
                font-size: clamp(0.9rem, 3vw, 1.125rem);
            }
            .header .space-y-3 p:last-child {
                font-size: 0.8rem;
            }
            .red-flame-logo {
                width: 28px;
                height: 40px;
            }
            /* Adjust flame internals proportionally smaller */
            .red-flame-logo-main { width: 22px; height: 34px; left: 3px; }
            .red-flame-logo-inner-orange-red { top: 3px; left: 6px; width: 18px; height: 26px; }
            .red-flame-logo-core-orange { top: 5px; left: 8px; width: 12px; height: 20px; }
            .red-flame-logo-inner-yellow-orange { top: 8px; left: 9px; width: 9px; height: 14px; }
            .red-flame-logo-center-hotspot { top: 10px; left: 10px; width: 5px; height: 8px; }
            .red-flame-logo-glow { width: 28px; height: 40px; }

            .language-selector-container {
                top: 0.5rem;
                right: 0.5rem;
                gap: 0.5rem;
            }
            body[dir="ar"] .language-selector-container {
                left: 0.5rem;
                right: auto;
            }
            .language-selector-container button {
                padding: 0.4rem 0.6rem;
                font-size: 0.75rem;
            }

            .card {
                padding: 1rem;
                border-radius: 1rem;
            }
            .card-header {
                gap: 0.5rem;
                margin-bottom: 1rem;
            }
            .card-header svg {
                width: 1.5rem;
                height: 1.5rem;
            }
            .card-header h2 {
                font-size: 1.1rem;
            }
            .form-input {
                padding: 0.6rem 0.8rem;
                font-size: 0.9rem;
                border-radius: 0.75rem;
            }
            textarea.form-input {
                min-height: 3rem;
            }
            .generate-btn {
                padding: 0.8rem 0;
                font-size: 1rem;
                border-radius: 1rem;
            }
            .generate-btn svg {
                width: 1rem;
                height: 1rem;
            }
            .output-section {
                padding: 1rem;
                border-radius: 1rem;
            }
            .output-header h2 {
                font-size: 1.1rem;
            }
            .copy-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }
            .output-content-box {
                min-height: 8rem;
                padding: 0.8rem;
                border-radius: 0.75rem;
            }
            .output-content-box pre {
                font-size: 0.8rem;
            }
            .output-content-box p.initial-text {
                padding-top: 1.5rem;
                padding-bottom: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Animated background particles container -->
    <div class="particle-container" id="particleContainer"></div>

    <!-- Language switcher with better spacing -->
    <div class="language-selector-container" id="languageSelectorContainer">
        <button value="en" class="active">English</button>
        <button value="ar">العربية</button>
        <button value="fr">Français</button>
    </div>

    <div class="container">
        <!-- Header with improved flame and spacing -->
        <div class="header">
            <div class="red-flame-logo">
                <div class="red-flame-logo-glow"></div>
                <div class="red-flame-logo-main"></div>
                <div class="red-flame-logo-inner-orange-red"></div>
                <div class="red-flame-logo-core-orange"></div>
                <div class="red-flame-logo-inner-yellow-orange"></div>
                <div class="red-flame-logo-center-hotspot"></div>
            </div>
            
            <h1 data-key="headerTitle">IgniteInbox</h1>
            
            <div class="space-y-3">
                <p data-key="headerTagline">Your AI-Powered Outreach Engine</p>
                <p data-key="headerDescription">Transform your cold outreach with personalized, high-converting emails generated by advanced AI</p>
            </div>
        </div>

        <!-- Main form structure using previous class names -->
        <div class="grid-container">
            <!-- Sender details -->
            <div class="card">
                <div class="card-header">
                    <!-- Lucide User icon (SVG inline) -->
              
                    <h2 data-key="yourSenderDetailsTitle">Your Sender Details</h2>
                </div>
                
                <div class="space-y-5">
                    <input type="text" id="senderName" name="senderName" data-key="yourNamePlaceholder" placeholder="Your Name" class="form-input" required>
                    <input type="email" id="senderEmail" name="senderEmail" data-key="yourEmailPlaceholder" placeholder="Your Email" class="form-input" required>
                    <input type="tel" id="senderPhone" name="senderPhone" data-key="yourPhonePlaceholder" placeholder="Your Phone Number (Optional)" class="form-input">
                    <input type="text" id="senderCompany" name="senderCompany" data-key="yourCompanyPlaceholder" placeholder="Your Company/Title (Optional)" class="form-input">
                </div>
            </div>

            <!-- Recipient details -->
            <div class="card">
                <div class="card-header">
                    <!-- Lucide Target icon (SVG inline) -->
                    
                    <h2 data-key="recipientDetailsTitle">Recipient & Pitch Details</h2>
                </div>
                
                <div class="space-y-5">
                    <input type="text" id="recipientName" name="recipientName" data-key="recipientNamePlaceholder" placeholder="Recipient's Name" class="form-input" required>
                    <input type="text" id="companyName" name="companyName" data-key="companyNamePlaceholder" placeholder="Company Name" class="form-input" required>
                    <input type="text" id="jobTitle" name="jobTitle" data-key="jobTitlePlaceholder" placeholder="Role/Job Title" class="form-input" required>
                    
                    <select id="emailTone" name="emailTone" class="form-input" required>
                        <option value="" data-key="selectTonePlaceholder">Select a tone for your email...</option>
                        <option value="formal" data-key="toneFormal">Formal & Professional</option>
                        <option value="friendly" data-key="toneFriendly">Friendly & Approachable</option>
                        <option value="bold" data-key="toneBold">Bold & Direct</option>
                        <option value="casual" data-key="toneCasual">Casual & Conversational</option>
                        <option value="persuasive" data-key="tonePersuasive">Highly Persuasive</option>
                    </select>
                    
                    <textarea id="productService" name="productService" data-key="productServicePlaceholder" placeholder="Product/Service to Pitch" rows="3" class="form-input"></textarea>
                </div>
            </div>
        </div>

        <!-- Generate button -->
        <button id="generateBtn" class="generate-btn">
            <div class="generate-btn-shine"></div>
            <!-- Lucide Rocket icon (SVG inline) -->
            <svg id="generateBtnIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rocket"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.75-.75 1.39-1.68 1.61-2.85A10.87 10.87 0 0 0 7.5 7.5c-2.43 2.07-3.64 5.31-2.91 9z"/><path d="M14 5c0-1.5 1-2 1-2s.5-1 2-1 2 1 2 1v2l-1 1h-2L14 5Z"/><path d="M10 15V9l4-4h4l1 1v4l-4 4h-4Z"/><path d="M8 17L5 20"/><path d="M13 18l-1 1"/><path d="M16 13l1-1"/><path d="M19 10l-1-1"/></svg>
            <span id="generateBtnText" data-key="generateButton">Generate Email</span>
        </button>

        <!-- Output section -->
        <div class="output-section">
            <div class="output-header">
                <div class="flex-gap-4">
                    <!-- Lucide Mail icon (SVG inline) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail text-pink-300"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                    <h2 data-key="generatedEmailTitle">Your Generated Email</h2>
                </div>
                
                <button id="copyBtn" class="copy-btn disabled">
                    <!-- Lucide Copy icon (SVG inline) -->
                    <svg id="copyBtnIcon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                    <span id="copyBtnText" data-key="copyButton">Copy to Clipboard</span>
                </button>
            </div>
            
            <div id="outputBox" class="output-content-box">
                <p class="initial-text" data-key="outputBoxInitialText">
                    Your perfectly crafted, AI-generated cold email will appear here, ready to send!
                </p>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = 'AIzaSyAMIen9b701UekKNPVEuICV42kFZmhoUs4';

        // Get DOM elements
        const languageButtons = document.querySelectorAll('#languageSelectorContainer button');
        const generateBtn = document.getElementById('generateBtn');
        const generateBtnIcon = document.getElementById('generateBtnIcon');
        const generateBtnText = document.getElementById('generateBtnText');
        const copyBtn = document.getElementById('copyBtn');
        const copyBtnIcon = document.getElementById('copyBtnIcon');
        const copyBtnText = document.getElementById('copyBtnText');
        const outputBox = document.getElementById('outputBox');
        const particleContainer = document.getElementById('particleContainer');

        // State variables (simulated with global variables and direct DOM manipulation)
        let formData = {
            senderName: '', senderEmail: '', senderPhone: '', senderCompany: '',
            recipientName: '', companyName: '', jobTitle: '', emailTone: '', productService: ''
        };
        let isLoading = false;
        let copySuccess = false;
        let generatedEmailContent = ''; // Stores the actual generated email text
        let currentLanguage = localStorage.getItem('selectedLanguage') || 'en'; // Initial language

        // --- Translations Object ---
        const translations = {
            en: {
                documentTitle: "IgniteInbox: Your AI-Powered Outreach Engine",
                headerTitle: "IgniteInbox",
                headerTagline: "Your AI-Powered Outreach Engine",
                headerDescription: "Transform your cold outreach with personalized, high-converting emails generated by advanced AI",
                yourSenderDetailsTitle: "Your Sender Details",
                yourNamePlaceholder: "Your Name",
                yourEmailPlaceholder: "Your Email",
                yourPhonePlaceholder: "Your Phone Number (Optional)",
                yourCompanyPlaceholder: "Your Company/Title (Optional)",
                recipientDetailsTitle: "Recipient & Pitch Details",
                recipientNamePlaceholder: "Recipient's Name",
                companyNamePlaceholder: "Company Name",
                jobTitlePlaceholder: "Role/Job Title",
                emailToneLabel: "Desired Email Tone",
                selectTonePlaceholder: "Select a tone for your email...",
                toneFormal: "Formal & Professional",
                toneFriendly: "Friendly & Approachable",
                toneBold: "Bold & Direct",
                toneCasual: "Casual & Conversational",
                tonePersuasive: "Highly Persuasive",
                productServicePlaceholder: "Product/Service to Pitch",
                generateButton: "Generate Email",
                generatedEmailTitle: "Your Generated Email",
                copyButton: "Copy to Clipboard",
                outputBoxInitialText: "Your perfectly crafted, AI-generated cold email will appear here, ready to send!",
                alertFillRequired: "Please fill in all required fields",
                generateButtonLoading: "Generating...",
                outputBoxLoading: "Crafting your perfect email...",
                copyButtonCopied: "Copied!",
                copyButtonFailed: "Failed to copy!",
                errorApi: "Error generating email: ",
                errorApiProblem: "\n\nPlease check the browser console for more details.",
                errorApi403: "\n\nPossible issue: Invalid or missing API key, or API not enabled for your project.",
                errorApi400: "\n\nPossible issue: Malformed request, rate limit exceeded, or content moderation violation.",
                errorApi500: "\n\nPossible issue: Google API server error. Please try again later.",
                errorApiInvalidResponse: "Invalid response format from API. Please try again or check API documentation.",
                signatureBestRegards: "Best regards,",
                signatureEmail: "Email:",
                signaturePhone: "Phone:"
            },
            fr: {
                documentTitle: "IgniteInbox: Votre Moteur d'Outreach IA",
                headerTitle: "IgniteInbox",
                headerTagline: "Votre Moteur d'Outreach IA",
                headerDescription: "Transformez votre prospection à froid avec des e-mails personnalisés et à fort taux de conversion générés par une IA avancée",
                yourSenderDetailsTitle: "Vos Coordonnées d'Expéditeur",
                yourNamePlaceholder: "Votre Nom",
                yourEmailPlaceholder: "Votre E-mail",
                yourPhonePlaceholder: "Votre Numéro de Téléphone (Facultatif)",
                yourCompanyPlaceholder: "Votre Entreprise/Titre (Facultatif)",
                recipientDetailsTitle: "Détails du Destinataire et du Pitch",
                recipientNamePlaceholder: "Nom du Destinataire",
                companyNamePlaceholder: "Nom de l'Entreprise",
                jobTitlePlaceholder: "Rôle/Titre du Poste",
                emailToneLabel: "Ton d'E-mail Souhaité",
                selectTonePlaceholder: "Sélectionnez un ton pour votre e-mail...",
                toneFormal: "Formel & Professionnel",
                toneFriendly: "Amicable & Abordable",
                toneBold: "Audacieux & Direct",
                toneCasual: "Décontracté & Conversationnel",
                tonePersuasive: "Très Persuasif",
                productServicePlaceholder: "Produit/Service à Proposer",
                generateButton: "Générer l'E-mail",
                generatedEmailTitle: "Votre E-mail Généré",
                copyButton: "Copier dans le Presse-papiers",
                outputBoxInitialText: "Votre e-mail froid, parfaitement rédigé par l'IA, apparaîtra ici, prêt à être envoyé !",
                alertFillRequired: "Veuillez remplir tous les champs obligatoires",
                generateButtonLoading: "Génération en cours...",
                outputBoxLoading: "Création de votre e-mail parfait...",
                copyButtonCopied: "Copié !",
                copyButtonFailed: "Échec de la copie !",
                errorApi: "Erreur lors de la génération de l'e-mail : ",
                errorApiProblem: "\n\nVeuillez vérifier la console du navigateur pour plus de détails.",
                errorApi403: "\n\nProblème possible : Clé API invalide ou manquante, ou API non activée pour votre projet.",
                errorApi400: "\n\nProblème possible : Requête malformée, limite de taux dépassée, ou violation de la modération du contenu.",
                errorApi500: "\n\nProblème possible : Erreur du serveur API Google. Veuillez réessayer plus tard.",
                errorApiInvalidResponse: "Format de réponse invalide de l'API. Veuillez réessayer ou consulter la documentation de l'API.",
                signatureBestRegards: "Cordialement,",
                signatureEmail: "E-mail :",
                signaturePhone: "Téléphone :"
            },
            ar: {
                documentTitle: "إجنايت إنبوكس: محرك التواصل الخاص بك بالذكاء الاصطناعي",
                headerTitle: "Ignit",
                headerTagline: "محرك التواصل الخاص بك بالذكاء الاصطناعي",
                headerDescription: "حوّل تواصلك البارد إلى رسائل بريد إلكتروني مخصصة وعالية التحويل يتم إنشاؤها بواسطة الذكاء الاصطناعي المتقدم",
                yourSenderDetailsTitle: "تفاصيل المرسل الخاصة بك",
                yourNamePlaceholder: "اسمك",
                yourEmailPlaceholder: "بريدك الإلكتروني",
                yourPhonePlaceholder: "رقم هاتفك (اختياري)",
                yourCompanyPlaceholder: "شركتك/منصبك (اختياري)",
                recipientDetailsTitle: "تفاصيل المستلم وعرض الموضوع",
                recipientNamePlaceholder: "اسم المستلم",
                companyNamePlaceholder: "اسم الشركة",
                jobTitlePlaceholder: "الدور/المسمى الوظيفي",
                emailToneLabel: "نبرة البريد الإلكتروني المطلوبة",
                selectTonePlaceholder: "اختر نبرة لبريدك الإلكتروني...",
                toneFormal: "رسمية ومهنية",
                toneFriendly: "ودودة وودودة",
                toneBold: "جريئة ومباشرة",
                toneCasual: "عفوية ومحادثة",
                tonePersuasive: "مقنعة للغاية",
                productServicePlaceholder: "المنتج/الخدمة المراد عرضها",
                generateButton: "إنشاء بريد إلكتروني",
                generatedEmailTitle: "بريدك الإلكتروني الذي تم إنشاؤه",
                copyButton: "نسخ إلى الحافظة",
                outputBoxInitialText: "سيظهر بريدك الإلكتروني البارد المصمم بشكل مثالي بواسطة الذكاء الاصطناعي هنا، جاهزًا للإرسال!",
                alertFillRequired: "يرجى ملء جميع الحقول المطلوبة",
                generateButtonLoading: "جاري الإنشاء...",
                outputBoxLoading: "إجنايت إنبوكس يشغل المحركات لصياغة بريدك الإلكتروني البارد المثالي...",
                copyButtonCopied: "تم النسخ!",
                copyButtonFailed: "فشل النسخ!",
                errorApi: "خطأ في إنشاء البريد الإلكتروني: ",
                errorApiProblem: "\n\nيرجى التحقق من وحدة تحكم المتصفح لمزيد من التفاصيل.",
                errorApi403: "\n\nمشكلة محتملة: مفتاح API غير صالح أو مفقود، أو API غير مفعل لمشروعك.",
                errorApi400: "\n\nمشكلة محتملة: طلب خاطئ، تجاوز حد المعدل، أو انتهاك اعتدال المحتوى.",
                errorApi500: "\n\nمشكلة محتملة: خطأ في خادم API Google. يرجى المحاولة مرة أخرى لاحقًا.",
                errorApiInvalidResponse: "تنسيق استجابة غير صالح من API. يرجى المحاولة مرة أخرى أو مراجعة وثائق API.",
                signatureBestRegards: "مع خالص التقدير،",
                signatureEmail: "البريد الإلكتروني:",
                signaturePhone: "الهاتف:"
            }
        };

        // --- Utility Functions ---

        function saveUserData() {
            for (const key in formData) {
                if (key.startsWith('sender')) {
                    localStorage.setItem(key, formData[key]);
                }
            }
        }

        function loadUserData() {
            for (const key of ['senderName', 'senderEmail', 'senderPhone', 'senderCompany']) {
                formData[key] = localStorage.getItem(key) || '';
                const inputElement = document.getElementById(key);
                if (inputElement) {
                    inputElement.value = formData[key];
                }
            }
        }

        // Applies translations to elements with data-key attributes
        function applyTranslations(lang) {
            const currentTranslations = translations[lang];
            if (!currentTranslations) {
                console.warn(`No translations found for language: ${lang}`);
                return;
            }

            document.title = currentTranslations.documentTitle;
            document.body.dir = (lang === 'ar') ? 'rtl' : 'ltr';

            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.dataset.key;
                if (currentTranslations[key]) {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = currentTranslations[key];
                    } else if (element.tagName === 'OPTION') {
                        element.textContent = currentTranslations[key];
                    } else if (element.tagName === 'BUTTON' || element.tagName === 'SPAN') {
                        // For buttons and spans that are text content
                        element.textContent = currentTranslations[key];
                    } else if (element.tagName === 'P' && element.classList.contains('initial-text')) {
                        element.textContent = currentTranslations.outputBoxInitialText; // Specific for initial text
                    } else {
                        // For H1, H2, H3, P that don't have explicit spans for icons
                        element.textContent = currentTranslations[key];
                    }
                }
            });

            // Handle elements with fixed emojis in HTML, as they need special handling for translation
            document.querySelector('.header h1').innerHTML = `✨ ${currentTranslations.headerTitle}`;
            document.querySelector('.card-header h2[data-key="yourSenderDetailsTitle"]').innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user text-blue-300"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                ${currentTranslations.yourSenderDetailsTitle}
            `;
            document.querySelector('.card-header h2[data-key="recipientDetailsTitle"]').innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-target text-green-300"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
                ${currentTranslations.recipientDetailsTitle}
            `;
            document.querySelector('.output-header h2[data-key="generatedEmailTitle"]').innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail text-pink-300"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                ${currentTranslations.generatedEmailTitle}
            `;
            
            // Update active language button
            languageButtons.forEach(button => {
                if (button.value === lang) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });

            // Ensure generate and copy button icons are updated correctly
            updateGenerateButtonState();
            updateCopyButtonState();
        }

        // --- Particle Background Logic ---
        function generateParticles(numParticles) {
            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                particle.style.animationDelay = `${Math.random() * 6}s`;
                particle.style.animationDuration = `${Math.random() * 3 + 3}s`;
                particleContainer.appendChild(particle);
            }
        }

        // --- Core Logic ---

        function handleInputChange(e) {
            formData[e.target.name] = e.target.value;
        }

        async function generateEmail() {
            const currentTranslations = translations[currentLanguage];

            // Validate required fields
            const requiredFields = ['senderName', 'senderEmail', 'recipientName', 'companyName', 'jobTitle', 'emailTone', 'productService'];
            const missingFields = requiredFields.filter(field => !formData[field]);

            if (missingFields.length > 0) {
                alert(currentTranslations.alertFillRequired);
                return;
            }

            isLoading = true;
            updateGenerateButtonState();
            setGeneratedEmailContent = "", // Clear previous email content
            outputBox.innerHTML = `
                <div class="flex flex-col items-center justify-center h-40 text-white/80">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-loader-2 loading-animation"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
                    <p class="loading-text">${currentTranslations.outputBoxLoading}</p>
                </div>
            `;
            copyBtn.classList.add('disabled');
            copyBtn.disabled = true;

            try {
                let signature = `\n\n${currentTranslations.signatureBestRegards},\n${formData.senderName}`;
                if (formData.senderCompany) {
                    signature += `\n${formData.senderCompany}`;
                }
                signature += `\n${currentTranslations.signatureEmail} ${formData.senderEmail}`;
                if (formData.senderPhone) {
                    signature += `\n${currentTranslations.signaturePhone} ${formData.senderPhone}`;
                }

                const prompt = `Write a ${formData.emailTone} cold email to ${formData.jobTitle} at ${formData.companyName} named ${formData.recipientName}. The email should pitch: ${formData.productService}.
                
The email language should be in ${currentLanguage === 'en' ? 'English' : currentLanguage === 'fr' ? 'French' : 'Arabic'}.

Make the email:
- Professional and personalized
- Include a compelling subject line (e.g., "Subject: Relevant Title")
- Have a clear call-to-action
- Be concise but persuasive
- Follow cold email best practices
- **Crucially, end the email with a professional closing and the sender's details:**
${signature}

Format the response as a complete email with Subject line and body.`;

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 1024,
                        }
                    }
                    )
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('API Error:', errorData);
                    let errorMessage = currentTranslations.errorApi + (errorData.error?.message || `HTTP error! Status: ${response.status}`);
                    if (response.status === 403) {
                        errorMessage += currentTranslations.errorApi403;
                    } else if (response.status === 400) {
                        errorMessage += currentTranslations.errorApi400;
                    } else if (response.status === 500) {
                        errorMessage += currentTranslations.errorApi500;
                    }
                    errorMessage += currentTranslations.errorApiProblem;
                    throw new Error(errorMessage);
                }

                const data = await response.json();
                
                if (!data.candidates || !data.candidates[0] || !data.candidates[0].content || !data.candidates[0].content.parts || !data.candidates[0].content.parts[0]) {
                    throw new Error(currentTranslations.errorApiInvalidResponse);
                }
                
                generatedEmailContent = data.candidates[0].content.parts[0].text;
                outputBox.innerHTML = `<pre class="text-white/90 whitespace-pre-wrap font-sans leading-relaxed">${generatedEmailContent}</pre>`;
                copyBtn.classList.remove('disabled');
                copyBtn.disabled = false;

            } catch (err) {
                console.error('Error generating email:', err);
                outputBox.innerHTML = `<p class="text-red-400 italic text-center py-12">${err.message}</p>`;
                generatedEmailContent = ''; // Clear content on error
                copyBtn.classList.add('disabled');
                copyBtn.disabled = true;
            } finally {
                isLoading = false;
                updateGenerateButtonState();
            }
        }

        async function copyToClipboard() {
            const currentTranslations = translations[currentLanguage];

            if (!generatedEmailContent) {
                alert(currentTranslations.alertFillRequired); // Re-use alert for consistency
                return;
            }

            try {
                await navigator.clipboard.writeText(generatedEmailContent);
                copySuccess = true;
                updateCopyButtonState();
                setTimeout(() => {
                    copySuccess = false;
                    updateCopyButtonState();
                }, 2000);
            } catch (err) {
                alert(currentTranslations.copyButtonFailed);
                console.error('Failed to copy to clipboard', err);
                copySuccess = false;
                updateCopyButtonState(); // Reset immediately
            }
        }

        // --- UI Update Functions ---

        function updateGenerateButtonState() {
            const currentTranslations = translations[currentLanguage];
            if (isLoading) {
                generateBtn.classList.add('disabled');
                generateBtn.disabled = true;
                generateBtnIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-loader-2 animate-spin"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>`;
                generateBtnText.textContent = currentTranslations.generateButtonLoading;
            } else {
                generateBtn.classList.remove('disabled');
                generateBtn.disabled = false;
                generateBtnIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rocket"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.75-.75 1.39-1.68 1.61-2.85A10.87 10.87 0 0 0 7.5 7.5c-2.43 2.07-3.64 5.31-2.91 9z"/><path d="M14 5c0-1.5 1-2 1-2s.5-1 2-1 2 1 2 1v2l-1 1h-2L14 5Z"/><path d="M10 15V9l4-4h4l1 1v4l-4 4h-4Z"/><path d="M8 17L5 20"/><path d="M13 18l-1 1"/><path d="M16 13l1-1"/><path d="M19 10l-1-1"/></svg>`;
                generateBtnText.textContent = currentTranslations.generateButton;
            }
        }

        function updateCopyButtonState() {
            const currentTranslations = translations[currentLanguage];
            if (copySuccess) {
                copyBtn.classList.add('success');
                copyBtnIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check"><polyline points="20 6 9 17 4 12"/></svg>`;
                copyBtnText.textContent = currentTranslations.copyButtonCopied;
            } else {
                copyBtn.classList.remove('success');
                copyBtnIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>`;
                copyBtnText.textContent = currentTranslations.copyButton;
            }
            // Ensure disabled state is managed externally (by generateEmail function)
        }

        // --- Event Listeners and Initial Setup ---

        // Attach input handlers
        document.querySelectorAll('.form-input').forEach(input => {
            input.addEventListener('input', handleInputChange);
        });

        generateBtn.addEventListener('click', generateEmail);
        copyBtn.addEventListener('click', copyToClipboard);

        // Language selector logic
        languageButtons.forEach(button => {
            button.addEventListener('click', () => {
                const newLang = button.value;
                if (newLang !== currentLanguage) {
                    currentLanguage = newLang;
                    localStorage.setItem('selectedLanguage', newLang);
                    applyTranslations(newLang);
                }
            });
        });

        // On DOMContentLoaded, load user data, set initial language, and generate particles
        document.addEventListener('DOMContentLoaded', () => {
            loadUserData();
            applyTranslations(currentLanguage);
            generateParticles(50); // Number of particles
        });
    </script>
</body>
</html>